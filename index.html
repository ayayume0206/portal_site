<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>捜査本部ポータル - きさらぎ町警察</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div class="portal-container">
    <h1 onclick="handleAdminClick()" style="cursor: default; user-select: none;">きさらぎ町警察本部 捜査支援システム</h1>
    <div class="subtitle">SEIREI CITY POLICE DEPT. - INTERNAL ACCESS ONLY</div>

    <div class="alert-banner" id="banner">
      ⚠️ 警告：認可された捜査員のみ利用可能です。
    </div>

    <div id="auth-section" class="registration-form">
      <div class="input-group">
        <label>チーム識別番号</label>
        <input type="text" id="team-id" placeholder="例: 8">
      </div>
      <div class="input-group">
        <label>捜査官名</label>
        <input type="text" id="user-name" placeholder="氏名を入力">
      </div>
      <div class="input-group">
        <label>担当専門分野（確定後は変更できません）</label>
        <select id="user-role">
          <option value="intel">捜査官（情報・聴取担当）</option>
          <option value="analysis">捜査官（解析・支援担当）</option>
          <option value="field">捜査官（現場・記録担当）</option>
        </select>
      </div>
      <button class="btn-submit" onclick="performLogin()">捜査権限を確定する</button>
    </div>

    <div class="menu-grid" id="main-menu" style="display:none;">
      <div class="menu-card" onclick="location.href='https://ayayume0206.github.io/ai_sns/'">
        <div class="card-title">SNS投稿アーカイブ</div>
        <div class="card-desc">関係者の過去の投稿、削除されたポストの断片を閲覧します。</div>
      </div>

      <div class="menu-card" onclick="location.href='https://ayayume0206.github.io/security_camera/'">
        <div class="card-title">防犯カメラ閲覧アーカイブ</div>
        <div class="card-desc">町内に設置された防犯カメラの静止画記録を照会します。</div>
      </div>

      <div class="menu-card" id="card-investigation" style="display:none;" onclick="location.href='https://ayayume0206.github.io/investigation/'">
        <div class="card-title">総合管理コンソール</div>
        <div class="card-desc">SNSアカウントへの開示請求、および重要参考人の事情聴取を行います。</div>
      </div>

      <div class="menu-card" id="card-guide" style="display:none;" onclick="location.href='https://ayayume0206.github.io/ai_guide/'">
        <div class="card-title">捜査支援専門官チャット</div>
        <div class="card-desc">本部の専門官へ解析依頼を出します。ヒントが取得可能です。</div>
      </div>
    </div>

    <div class="footer">
      &copy; 2026 Kisaragi-machi Police Department.
    </div>
  </div>

  <script>
    window.onload = function() {
      if (localStorage.getItem('mystery_role')) {
        showMenu();
      }
    };

    function performLogin() {
      const team = document.getElementById('team-id').value;
      const name = document.getElementById('user-name').value;
      const role = document.getElementById('user-role').value;

      if (!team || !name) return alert("情報を入力してください。");

      localStorage.setItem('mystery_team', team);
      localStorage.setItem('mystery_name', name);
      localStorage.setItem('mystery_role', role);
      
      showMenu();
    }

    function showMenu() {
      const role = localStorage.getItem('mystery_role');
      const team = localStorage.getItem('mystery_team');
      const name = localStorage.getItem('mystery_name');

      document.getElementById('auth-section').style.display = 'none';
      document.getElementById('banner').innerHTML = `✅ 端末認証済み：${team} ${name} 捜査官`;
      document.getElementById('main-menu').style.display = 'grid';

      if (role === 'intel') {
        document.getElementById('card-investigation').style.display = 'flex';
      } else if (role === 'analysis') {
        document.getElementById('card-guide').style.display = 'flex';
      }
    }

    // --- 運営用リセットギミック ---
    let clickCount = 0;
    function handleAdminClick() {
      clickCount++;
      if (clickCount >= 3) { // 3回連続クリック
        const pass = prompt("運営用コードを入力してください");
        if (pass === "0204") {
          localStorage.clear();
          alert("端末を初期化しました。");
          location.reload();
        }
        clickCount = 0;
      }
      // 2秒間何もしないとカウントリセット
      setTimeout(() => { clickCount = 0; }, 2000);
    }
  </script>
</body>
</html>